<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <title>Venta de Vehículos</title>
</head>
<body>

    <header>
        <div class="logo">
            <img src="imagenes/logo.png" alt="AutoSource">
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="coches.html">Vehiculos</a></li>
                <li><a href="cotizaciones.html">Cotizaciones</a></li>
                <li><a href="proxi.html">Proximamente</a></li>
            </ul>
        </nav>
        <div class="iconos">
            <a href="inicio_secion.html">Login</a>
        </div>
    </header>

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">Inicio</a></li>
          <li class="breadcrumb-item active" aria-current="page">Vehiculos</li>
        </ol>
    </nav>

    <div class="search-container">
        <input type="text" id="search-bar" placeholder="Buscar vehículo..." onkeyup="searchVehicle()">
    </div>

    <div class="vehicle-grid" id="vehicle-grid">
        <!-- Ejemplo de vehículo con cantidad -->
        <div class="vehicle-card" data-name="Ford Explorer" data-cantidad="10" onclick="window.location.href='detalles.html'">
            <img src="http://localhost:5000/imagenes/ford2020.png" alt="Ford Explorer">
            <h3>Ford Explorer</h3>
            <p>Marca: Ford</p>
            <p>Año: 2020</p>
            <p>Precio: $120,000</p>
            <p>Cantidad disponible: <span class="cantidad">10</span></p> <!-- Mostrando la cantidad -->
        </div>
        <div class="vehicle-card" data-name="Toyota RAV4 Prime" data-cantidad="5" onclick="window.location.href='detalles1.html'">
            <img src="imagenes/toyota2021.jfif" alt="Vehículo 2">
            <h3>Toyota RAV4 Prime</h3>
            <p>Marca: Toyota</p>
            <p>Año: 2021</p>
            <p>Precio: $172,500</p>
            <p>Cantidad disponible: <span class="cantidad">5</span></p> <!-- Mostrando la cantidad -->
        </div>
        <div class="vehicle-card" data-name="BMW 740i" data-cantidad="3" onclick="window.location.href='detalles2.html'">
            <img src="imagenes/BMW2019.jfif" alt="Vehículo 3">
            <h3>BMW 740i</h3>
            <p>Marca: BMW</p>
            <p>Año: 2019</p>
            <p>Precio: $235,000</p>
            <p>Cantidad disponible: <span class="cantidad">3</span></p> <!-- Mostrando la cantidad -->
        </div>
        <div class="vehicle-card" data-name="Nissan Sentra" data-cantidad="8" onclick="window.location.href='detalles3.html'">
            <img src="imagenes/NISAN2019.jfif" alt="Vehículo 4">
            <h3>Nissan Sentra S</h3>
            <p>Marca: Nissan</p>
            <p>Año: 2017</p>
            <p>Precio: $95,000</p>
            <p>Cantidad disponible: <span class="cantidad">8</span></p> <!-- Mostrando la cantidad -->
        </div>
        <div class="vehicle-card" data-name="Ford Fusion" data-cantidad="12" onclick="window.location.href='detalles4.html'">
            <img src="imagenes/fordfusion2012.jfif" alt="Vehículo 5">
            <h3>Ford Fusion</h3>
            <p>Marca: Ford</p>
            <p>Año: 2012</p>
            <p>Precio: $120,000</p>
            <p>Cantidad disponible: <span class="cantidad">12</span></p> <!-- Mostrando la cantidad -->
        </div>
        <div class="vehicle-card" data-name="Mercedes-Benz" data-cantidad="2" onclick="window.location.href='detalles5.html'">
            <img src="imagenes/m.jpg" alt="Vehículo 5">
            <h3>Mercedes-Benz</h3>
            <p>Marca: Mercedes-AMG G63</p>
            <p>Año: 2025</p>
            <p>Precio: $4,869,945</p>
            <p>Cantidad disponible: <span class="cantidad">2</span></p> <!-- Mostrando la cantidad -->
        </div>
        <!-- Agrega más vehículos según sea necesario -->
    </div>

    <footer>
        <p>Síguenos en:</p>
        <div class="redes">
            <a href="https://www.facebook.com"><i class="fab fa-facebook-f"></i></a>
            <a href="https://www.twitter.com"><i class="fab fa-twitter"></i></a>
            <a href="https://www.instagram.com"><i class="fab fa-instagram"></i></a>
            <a href="http://www.youtube.com"><i class="fab fa-youtube"></i></a>
        </div>

        <section class="mapa-sitio">
            <h3>Mapa de sitio</h3>
            <ul class="mapa-lista">
                <li><a href="coches.html">Vehículos</a></li>
                <li><a href="cotizaciones.html">Cotizaciones</a></li>
                <li><a href="servicio.html">Servicios</a></li>
                <li><a href="localizar.html">Localiza tu Distribuidor</a></li>
                <li><a href="prueba.html">Prueba de Manejo</a></li>
                <li><a href="proxi.html">Próximamente</a></li>
                <li><a href="contacto.html">Contacto</a></li>
            </ul>
        </section>
    </footer>

<script>
    function searchVehicle() {
        var input, filter, grid, cards, card, name, i, txtValue;
        input = document.getElementById("search-bar");
        filter = input.value.toLowerCase();  // Convierte todo a minúsculas
        grid = document.getElementById("vehicle-grid");
        cards = grid.getElementsByClassName("vehicle-card");

        for (i = 0; i < cards.length; i++) {
            card = cards[i];
            name = card.getAttribute("data-name").toLowerCase();  // Convierte el nombre del vehículo a minúsculas
            txtValue = name;
            if (txtValue.indexOf(filter) > -1) {
                card.style.display = "";  // Muestra la tarjeta si coincide
            } else {
                card.style.display = "none";  // Oculta la tarjeta si no coincide
            }
        }
    }
</script>
<script>
document.addEventListener("DOMContentLoaded", async () => {
    const vehicleGrid = document.getElementById("vehicle-grid");

    try {
        const response = await fetch("http://localhost:5000/api/autos");
        const cars = await response.json();

        vehicleGrid.innerHTML = ""; // Limpiar el contenedor antes de agregar elementos

         console.log(cars);  // Verificar la estructura de los datos

        vehicleGrid.innerHTML = ""; // Limpiar el contenedor antes de agregar elementos


        cars.forEach(car => {
            // Verificación para asegurarse de que 'price' y otras propiedades existan
            const priceFormatted = car.precio ? car.precio.toLocaleString("es-MX") : "Precio no disponible";
           const imageUrl = car.imageUrl ? `http://localhost:5000/imagenes/${car.imageUrl}` : "http://localhost:5000/imagenes/ruta_por_defecto.jpg";

            // Asegurarse de que 'quantity' esté definida o establecer un valor predeterminado
            const quantity = car.quantity || "Cantidad no disponible"; // Si no existe, poner un mensaje predeterminado
console.log(imageUrl); // Verifica la URL que se está generando

            // Crear tarjeta de vehículo
            const carCard = document.createElement("div");
            carCard.classList.add("vehicle-card");
            carCard.onclick = () => window.location.href = `detalles.html?id=${car._id}`;



            carCard.innerHTML = `
                <img src="${imageUrl}" alt="${car.modelo}">
                <h3>${car.marca} ${car.modelo}</h3>
                <p>Marca: ${car.marca}</p>
                <p>Año: ${car.anio}</p>
                <p>Precio: $${priceFormatted}</p>
                <p>Cantidad disponible: <span class="cantidad">${car.quantity || 'Cantidad no disponible'}</span></p>
            `;

            vehicleGrid.appendChild(carCard);
        });
    } catch (error) {
        console.error("Error al cargar los autos:", error);
    }
});

</script>


</body>
</html>

